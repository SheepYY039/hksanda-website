{"version":3,"file":"class-d47cf5ea.js","sources":["../../../../components/ClassInfoCard.vue","../../../../apollo/class.js","../../../../pages/course/class.vue"],"sourcesContent":["<template>\n    <!--<div class=\"row\">-->\n    <!--<div class=\"\">-->\n    <span class=\"class my-4 col-12 col-lg-6 class__info\">\n        <h3 class=\"h3\">{{ session.title }} （{{ session.type }}）</h3>\n\n        <dl class=\"row h5\">\n            <template v-if=\"session.classroom\">\n                <dt class=\"col-3\">教室</dt>\n                <dd class=\"col-9\">（{{ session.classroom }}）上课</dd>\n            </template>\n            <dt class=\"col-3\">时间：</dt>\n            <dd class=\"col-9\">逢{{ session.time }}</dd>\n            <dt class=\"col-3\">對象</dt>\n            <dd class=\"col-9\">\n                {{ session.students }}\n            </dd>\n            <template v-if=\"session.location\">\n                <dt class=\"col-3\">地点</dt>\n                <dd class=\"col-9\">\n                    {{ session.location }}\n                </dd>\n            </template>\n        </dl>\n\n        <Button v-if=\"isAdmin\" :label=\"`編輯 ${session.type}`\" class=\"p-button-primary p-button-sm\" type=\"submit\"\n            @click=\"edit(session)\" />\n        <ConfirmPopup />\n        <Button v-if=\"isAdmin\" class=\"p-button-danger p-button-outlined p-button-sm ml-2\" icon=\"pi pi-times\" label=\"删除\"\n            @click=\"confirm($event, session)\" />\n    </span>\n    <!--</div>-->\n    <!--\n  <div\n  v-show=\"session.mapQuery\"\n  class=\"col-12 col-lg-6\"\n  >\n  <iframe\n  :src=\"`https://maps.google.com/maps?f=q&source=s_q&hl=zh-HK&geocode=&q=${session.mapQuery}&aq=&ie=UTF8&t=m&z=17&output=embed`\"\n  :title=\"`${session.mapQuery}-Map`\"\n  height=\"100%\"\n  width=\"100%\"\n  frameborder=\"0\"\n  scrolling=\"no\"\n  />\n  </div>\n-->\n    <!--</div>-->\n</template>\n\n<script setup>\n\nconst props = defineProps({\n    session: {\n        type: Object,\n        default: () => ({\n            title: \"\",\n            type: \"\",\n            students: null,\n            location: null,\n            mapQuery: null,\n            classroom: null,\n        }),\n    },\n    edit: {\n        type: Function,\n        required: true\n    }, remove: {\n        type: Function,\n        required: true\n    },\n    isAdmin: Boolean\n})\n\n\nfunction confirm(event, session) {\n    this.$confirm.require({\n        target: event.currentTarget,\n        message: '你确定要删除吗？',\n        icon: 'pi pi-info-circle',\n        acceptClass: 'p-button-danger',\n        accept: () => {\n            props.remove(session)\n            this.$toast.add({ severity: 'info', summary: '成功', detail: '已成功删除', life: 3000 });\n        },\n        reject: () => {\n            // this.$toast.add({severity: 'error', summary: 'Rejected', detail: 'You have rejected', life: 3000});\n        }\n    });\n}\n\n</script>\n\n<style lang=\"scss\" scoped>\n.class {\n    .class__info {\n\n        // margin: 10px;\n        &>p {\n            line-height: 2em !important;\n        }\n    }\n}\n</style>\n","import gql from 'graphql-tag'\n\nexport const GET_CLASSES = gql`\n    query GetClassesQuery {\n        getClasses {\n            id\n            title\n            type\n            classroom\n            time\n            students\n            location\n            mapQuery\n        }\n    }\n`;\n\nexport const UPDATE_CLASS = gql`\n    mutation updateClassMutation($details: ClassInput) {\n        updateClass(details: $details) {\n            id\n            title\n            type\n            classroom\n            time\n            students\n            location\n            mapQuery\n        }\n    }\n`;\n\nexport const ADD_CLASS = gql`\n    mutation addClassMutation($details: ClassInput) {\n        addClass(details: $details) {\n            id\n            title\n            type\n            classroom\n            time\n            students\n            location\n            mapQuery\n        }\n    }\n`;\n\nexport const REMOVE_CLASS = gql`\n    mutation removeClassMutation($classId: ID) {\n        removeClass(classId: $classId) {\n            id\n            title\n            type\n            classroom\n            time\n            students\n            location\n            mapQuery\n        }\n    }\n`;\n","<template>\n    <h1>常規課程及地點</h1>\n    <button v-if=\"getIsAdmin\" class=\"btn btn-success\" type=\"submit\" @click=\"create\">\n        添加課堂\n    </button>\n    <div class=\"container\">\n        <div class=\"row\">\n            <class-info-card v-for=\"session in getClasses\" :key=\"session.id\" :edit=\"edit\" :is-admin=\"getIsAdmin\"\n                :remove=\"remove\" :session=\"session\" />\n        </div>\n    </div>\n</template>\n\n\n<script setup>\nimport { ADD_CLASS, GET_CLASSES, REMOVE_CLASS, UPDATE_CLASS } from \"@/apollo/class\";\nimport { ClassInfoCard } from '#components';\n\nconst store = useMainStore();\n\nconst { getIsAdmin } = storeToRefs(store);\n\nconst { data } = await useAsyncQuery(GET_CLASSES);\nconst getClasses = data.value?.getClasses;\nconst { toggleModel } = store;\n\n\nfunction remove(sessionDetails) {\n    console.log(\"remove: \", sessionDetails)\n    const { mutate } = useMutation(REMOVE_CLASS, {\n        classId: sessionDetails.id,\n    });\n\n}\n\nfunction edit(sessionDetails) {\n    console.log(\"edit: \", sessionDetails)\n    const modelDetails = {\n        content: sessionDetails,\n        submitFunction: submitChange,\n        type: \"class\",\n    };\n    toggleModel(modelDetails);\n}\n\nfunction create() {\n    const modelDetails = {\n        content: {\n            title: \"\",\n            type: \"\",\n            students: null,\n            location: null,\n            mapQuery: null,\n            classroom: null,\n        },\n        submitFunction: submitChange,\n        type: \"class\",\n    };\n    toggleModel(modelDetails);\n}\n\nfunction newClassSession(classDetails) {\n    const { mutate } = useMutation(ADD_CLASS, {\n        details: classDetails\n    });\n}\n\nfunction updateClassSession(classDetails) {\n    console.log(classDetails);\n    const { mutate } = useMutation(UPDATE_CLASS, {\n        details: classDetails,\n    });\n}\n\nfunction submitChange(newContent) {\n    console.log(newContent)\n\n    if (newContent.classId) {\n        // Class Exists already\n        updateClassSession(newContent)\n    } else {\n        // this is a new class\n        newClassSession(newContent)\n    }\n}\n</script>\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2EA,aAAS,QAAQ,OAAO,SAAS;AAC7B,WAAK,SAAS,QAAQ;AAAA,QAClB,QAAQ,MAAM;AAAA,QACd,SAAS;AAAA,QACT,MAAM;AAAA,QACN,aAAa;AAAA,QACb,QAAQ,MAAM;AACV,gBAAM,OAAO,OAAO;AACpB,eAAK,OAAO,IAAI,EAAE,UAAU,QAAQ,SAAS,MAAM,QAAQ,SAAS,MAAM,IAAM,CAAA;AAAA,QACnF;AAAA,QACD,QAAQ,MAAM;AAAA,QAEb;AAAA,MACT,CAAK;AAAA,IACL;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACvFO,MAAM,cAAc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAepB,MAAM,eAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAerB,MAAM,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAelB,MAAM,eAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;AC7B5B,UAAM,QAAQ,aAAY;AAE1B,UAAM,EAAE,WAAY,IAAG,YAAY,KAAK;AAExC,UAAM,EAAE,KAAM,kDAAS,cAAc,WAAW,CAAA;AAChD,UAAM,cAAa,UAAK,UAAL,mBAAY;AAC/B,UAAM,EAAE,YAAa,IAAG;AAGxB,aAAS,OAAO,gBAAgB;AAC5B,cAAQ,IAAI,YAAY,cAAc;AACnB,kBAAY,cAAc;AAAA,QACzC,SAAS,eAAe;AAAA,MAChC,CAAK;AAAA,IAEL;AAEA,aAAS,KAAK,gBAAgB;AAC1B,cAAQ,IAAI,UAAU,cAAc;AACpC,YAAM,eAAe;AAAA,QACjB,SAAS;AAAA,QACT,gBAAgB;AAAA,QAChB,MAAM;AAAA,MACd;AACI,kBAAY,YAAY;AAAA,IAC5B;AAkBA,aAAS,gBAAgB,cAAc;AAChB,kBAAY,WAAW;AAAA,QACtC,SAAS;AAAA,MACjB,CAAK;AAAA,IACL;AAEA,aAAS,mBAAmB,cAAc;AACtC,cAAQ,IAAI,YAAY;AACL,kBAAY,cAAc;AAAA,QACzC,SAAS;AAAA,MACjB,CAAK;AAAA,IACL;AAEA,aAAS,aAAa,YAAY;AAC9B,cAAQ,IAAI,UAAU;AAEtB,UAAI,WAAW,SAAS;AAEpB,2BAAmB,UAAU;AAAA,MACrC,OAAW;AAEH,wBAAgB,UAAU;AAAA,MAC7B;AAAA,IACL;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}