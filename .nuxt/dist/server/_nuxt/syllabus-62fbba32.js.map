{"version":3,"file":"syllabus-62fbba32.js","sources":["../../../../pages/assessments/syllabus.vue"],"sourcesContent":["<template>\n    <h1>武術自衛散打 - 考试动作</h1>\n    <DeferredContent>\n        <TabView :scrollable=\"true\">\n            <TabPanel v-for=\"(syllabus, index) in getAssessmentSyllabus\" :key=\"syllabus.id\" :header=\"syllabus.level\">\n                <Button v-if=\"getIsAdmin\" label=\"添加項目\" @click=\"create(index)\" />\n                <ol class=\"list-group list-group-flush list-group-numbered\">\n                    <li v-for=\"(item, i) in syllabus.syllabus\" :key=\"item\" class=\"list-group-item\">\n                        {{ item }}\n                        <button v-if=\"getIsAdmin\" class=\"btn btn-primary mb-3\" type=\"submit\" @click=\"edit(index, i)\">\n                            編輯\n                        </button>\n                    </li>\n                </ol>\n            </TabPanel>\n        </TabView>\n    </DeferredContent>\n</template>\n\n<script setup>\nimport { GET_SYLLABUS, MODIFY_SYLLABUS } from \"@/apollo/assessment-syllabus\";\n// import {useMeta} from \"vue-meta\";\n\nconst { data } = await useAsyncQuery(GET_SYLLABUS);\nconst getAssessmentSyllabus = data?.value?.getAssessmentSyllabus;\nconst editingSyllabus = ref(-1);\nconst syllabusIndex = ref(-1);\n\nconst store = useMainStore();\nconst { getIsAdmin } = storeToRefs(store);\nconst { toggleModel } = store;\n\nfunction edit(index, i) {\n    editingSyllabus.value = index;\n    syllabusIndex.value = i;\n    const modelDetails = {\n        content: getAssessmentSyllabus[index].syllabus[i],\n        submitFunction: submitChange,\n        type: \"syllabus\",\n    };\n    toggleModel(modelDetails);\n}\n\nfunction create(index) {\n    editingSyllabus.value = index;\n    syllabusIndex.value = -1;\n    const modelDetails = {\n        content: \"\",\n        submitFunction: submitChange,\n        type: \"syllabus\",\n    };\n    toggleModel(modelDetails);\n}\n\nfunction submitChange(newContent) {\n    // id of view\n    const assessment = Object.assign(\n        {},\n        getAssessmentSyllabus[editingSyllabus.value]\n    );\n\n    let syllabus = Object.assign([], assessment.syllabus);\n    if (syllabusIndex.value >= 0) {\n        syllabus[syllabusIndex.value] = newContent;\n    } else {\n        syllabus.push(newContent);\n    }\n    const { mutate } = useMutation(MODIFY_SYLLABUS, {\n        level: {\n            level: assessment.name,\n            levelId: assessment.id,\n            syllabus: syllabus,\n        },\n    });\n    editingSyllabus.value = -1;\n    syllabusIndex.value = -1;\n}\n\n\n</script>\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuBA,UAAM,EAAE,KAAM,kDAAS,cAAc,YAAY,CAAA;AACjD,UAAM,yBAAwB,kCAAM,UAAN,mBAAa;AAC3C,UAAM,kBAAkB,IAAI,EAAE;AAC9B,UAAM,gBAAgB,IAAI,EAAE;AAE5B,UAAM,QAAQ,aAAY;AAC1B,UAAM,EAAE,WAAY,IAAG,YAAY,KAAK;AACxC,UAAM,EAAE,YAAa,IAAG;AAExB,aAAS,KAAK,OAAO,GAAG;AACpB,sBAAgB,QAAQ;AACxB,oBAAc,QAAQ;AACtB,YAAM,eAAe;AAAA,QACjB,SAAS,sBAAsB,KAAK,EAAE,SAAS,CAAC;AAAA,QAChD,gBAAgB;AAAA,QAChB,MAAM;AAAA,MACd;AACI,kBAAY,YAAY;AAAA,IAC5B;AAEA,aAAS,OAAO,OAAO;AACnB,sBAAgB,QAAQ;AACxB,oBAAc,QAAQ;AACtB,YAAM,eAAe;AAAA,QACjB,SAAS;AAAA,QACT,gBAAgB;AAAA,QAChB,MAAM;AAAA,MACd;AACI,kBAAY,YAAY;AAAA,IAC5B;AAEA,aAAS,aAAa,YAAY;AAE9B,YAAM,aAAa,OAAO;AAAA,QACtB,CAAE;AAAA,QACF,sBAAsB,gBAAgB,KAAK;AAAA,MACnD;AAEI,UAAI,WAAW,OAAO,OAAO,CAAA,GAAI,WAAW,QAAQ;AACpD,UAAI,cAAc,SAAS,GAAG;AAC1B,iBAAS,cAAc,KAAK,IAAI;AAAA,MACxC,OAAW;AACH,iBAAS,KAAK,UAAU;AAAA,MAC3B;AACkB,kBAAY,iBAAiB;AAAA,QAC5C,OAAO;AAAA,UACH,OAAO,WAAW;AAAA,UAClB,SAAS,WAAW;AAAA,UACpB;AAAA,QACH;AAAA,MACT,CAAK;AACD,sBAAgB,QAAQ;AACxB,oBAAc,QAAQ;AAAA,IAC1B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}